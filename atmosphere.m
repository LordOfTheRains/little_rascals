function [tinf, pinf, rho, sound]=atmosphere(alt);
gam=1.4;
p1=2116.2;
t1=518.69;
rho1=.0023778;
g0=32.174;
r=1718;
a=-.00356;
t36k=t1+a*36150;
p36k=p1*(t36k/t1)^(-g0/a/r);
t82k=t36k;
p82k=p36k*exp(-g0*(172500-155500)/r/t82k);
a=.001306;
t155k=t82k+a*(155500-82300);
p155k=p82k*(t155k/t82k)^(-g0/a/r);
t172k=t155k;
p172k=p155k*exp(-g0*(172500-155500)/r/t172k);
a=-.001097;
t200k=t172k+a*(200000-172500);
p200k=p172k*(t200k/t172k)^(-g0/a/r);
a=-.002109;
t262k=t200k+a*(262500-200000);
p262k=p200k*(t262k/t200k)^(-g0/a/r);
t295k=t262k;
p295k=p262k*exp(-g0*(295500-262500)/r/t295k);
a=.002;
t350k=t295k+a*(350000-295000);
p350k=p295k*(t350k/t295k)^(-g0/a/r);
a=.0076;
t450k=t350k+a*100000;
p450k=p350k*(t450k/t350k)^(-g0/a/r);
rho450k=p450k/r/t450k;
rho=0;
if alt<36150;
    a=-.00356;
    tinf=t1+a*alt;
    pinf=p1*(tinf/t1)^(-g0/a/r);
elseif alt<82300;
    altiso=36150;
    tinf=t36k;
    pinf=p36k*exp(-g0*(alt-altiso)/r/tinf);
elseif alt<155500;
    a=.001306;
    altiso=82300;
    tinf=t82k+a*(alt-altiso);
    pinf=p82k*(tinf/t82k)^(-g0/a/r);
elseif alt<172500;
    altiso=155500;
    tinf=t155k;
    pinf=p155k*exp(-g0*(alt-altiso)/r/tinf);
elseif alt<200000;
    a=-.001097;
    altiso=172500;
    tinf=t172k+a*(alt-altiso);
    pinf=p172k*(tinf/t172k)^(-g0/a/r);
elseif alt<262500;
    a=-.002109;
    altiso=200000;
    tinf=t200k+a*(alt-altiso);
    pinf=p200k*(tinf/t200k)^(-g0/a/r);
elseif alt<295500;
    altiso=262500;
    tinf=t262k;
    pinf=p262k*exp(-g0*(alt-altiso)/t/tinf);
elseif alt<350000;
    a=.002;
    altiso=295500;
    tinf=t295k+a*(alt-altiso);
    pinf=p295k*(tinf/t295k)^(-g0/a/r);
elseif alt<450000;
    a=.0076;
    altiso=350000;
    tinf=t350k+a*(alt-altiso);
    pinf=p350k*(tinf/t350k)^(-g0/a/r);
else;
    pinf=p450k;
    tinf=t450k;
    rho=rho450k;
end;
if rho==0;
    rho=pinf/r/tinf;
end;
sound=sqrt(gam*pinf/rho);